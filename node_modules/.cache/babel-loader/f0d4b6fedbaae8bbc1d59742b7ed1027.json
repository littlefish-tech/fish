{"ast":null,"code":"import _defineProperty from\"/Users/yimeng/Documents/fish/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/Users/yimeng/Documents/fish/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/yimeng/Documents/fish/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/yimeng/Documents/fish/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/yimeng/Documents/fish/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/yimeng/Documents/fish/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/yimeng/Documents/fish/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/yimeng/Documents/fish/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import'semantic-ui-css/semantic.min.css';// import axios from 'axios';\nimport Register from\"./Register\";import{Button,Form,Grid,Header,Message,Segment}from'semantic-ui-react';import{bS}from'../BabyTalk';import{gS}from'../gSession';var LoginDialog=/*#__PURE__*/function(_React$Component){_inherits(LoginDialog,_React$Component);var _super=_createSuper(LoginDialog);function LoginDialog(){var _this;_classCallCheck(this,LoginDialog);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={_userName:null,_passWord:null,Message:null,inError:false};_this.localChange=_this.handleChange.bind(_assertThisInitialized(_this));_this.localSubmit=_this.handleSubmit.bind(_assertThisInitialized(_this));return _this;}_createClass(LoginDialog,[{key:\"handleSubmit\",value:function(){var _handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var uData,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();// don't reload the page\nuData={userName:this.state._userName,passWord:this.state._passWord};// axios.post('/loginVerify', uData)\n//     .then(res => {                // and add it to the post\n// \t// we want to update the App state!!\n// \t// this component wants to update App's curUser\n// \tif (res.data.id === -1) {\n// \t    this.setState({Message :  \"Login failure\"})\n// \t    this.setState({inError : true})\n// \t}\n// \telse {\n// \t    this.props.updateAppState(this.props.appKey, res.data);\n// \t}\n//     }).catch(err => {\n// \tconsole.log(err)\n//     })\n_context.next=4;return bS.send('/loginVerify',uData);case 4:data=_context.sent;if(!(data.id===-1)){_context.next=10;break;}this.setState({Message:\"Login failure\"});this.setState({inError:true});_context.next=14;break;case 10:gS.setCreds(data);_context.next=13;return gS.restore();case 13:// wait until we get the session\n//back from the server\nthis.props.updateAppState(this.props.appKey,data);// setting the curUser in App \n// set the username \ncase 14:case\"end\":return _context.stop();}}},_callee,this);}));function handleSubmit(_x){return _handleSubmit.apply(this,arguments);}return handleSubmit;}()},{key:\"handleChange\",value:function handleChange(e){this.setState(_defineProperty({},e.target.name,e.target.value));if(this.state.inError){this.setState({inError:false});}}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Header,{as:\"h2\",color:\"teal\",textAlign:\"center\"},\"Fish Login\"),/*#__PURE__*/React.createElement(Form,{size:\"large\",onSubmit:this.localSubmit,error:this.state.inError},/*#__PURE__*/React.createElement(Segment,{stacked:true},/*#__PURE__*/React.createElement(Form.Input,{fluid:true,icon:\"user\",iconPosition:\"left\",placeholder:\"UserName\",type:\"text\",name:\"_userName\",onChange:this.localChange}),/*#__PURE__*/React.createElement(Form.Input,{fluid:true,icon:\"lock\",iconPosition:\"left\",placeholder:\"Password\",type:\"password\",name:\"_passWord\",onChange:this.localChange}),/*#__PURE__*/React.createElement(Button,{color:\"teal\",fluid:true,size:\"large\"},\"Login\"),/*#__PURE__*/React.createElement(Message,{error:true,content:this.state.Message}))));}}]);return LoginDialog;}(React.Component);var RegisterButton=/*#__PURE__*/function(_React$Component2){_inherits(RegisterButton,_React$Component2);var _super2=_createSuper(RegisterButton);function RegisterButton(){_classCallCheck(this,RegisterButton);return _super2.apply(this,arguments);}_createClass(RegisterButton,[{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(Button,{color:\"orange\",fluid:true,onClick:this.props.show},\"Register New Fish\");}}]);return RegisterButton;}(React.Component);var LoginForm=/*#__PURE__*/function(_React$Component3){_inherits(LoginForm,_React$Component3);var _super3=_createSuper(LoginForm);function LoginForm(){var _this2;_classCallCheck(this,LoginForm);for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2];}_this2=_super3.call.apply(_super3,[this].concat(args));_this2.state={showRegister:false// control the visibility of Register Modal\n// initially  false\n// goes to true when Register button is clicked\n// goes to false when we close the Register Modal\n};return _this2;}_createClass(LoginForm,[{key:\"showModal\",value:function showModal(e){this.setState({showRegister:true});}},{key:\"killModal\",value:function killModal(e){this.setState({showRegister:false});}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Grid,{textAlign:\"center\",style:{height:'100vh'},verticalAlign:\"middle\"},/*#__PURE__*/React.createElement(Grid.Column,{style:{maxWidth:450}},/*#__PURE__*/React.createElement(Register,{show:this.state.showRegister,kill:this.killModal.bind(this)}),/*#__PURE__*/React.createElement(LoginDialog,{updateAppState:this.props.updateAppState,appKey:this.props.appKey}),/*#__PURE__*/React.createElement(RegisterButton,{show:this.showModal.bind(this)}))));}}]);return LoginForm;}(React.Component);export default LoginForm;","map":{"version":3,"sources":["/Users/yimeng/Documents/fish/src/components/Login.js"],"names":["React","Register","Button","Form","Grid","Header","Message","Segment","bS","gS","LoginDialog","state","_userName","_passWord","inError","localChange","handleChange","bind","localSubmit","handleSubmit","e","preventDefault","uData","userName","passWord","send","data","id","setState","setCreds","restore","props","updateAppState","appKey","target","name","value","Component","RegisterButton","show","LoginForm","showRegister","height","maxWidth","killModal","showModal"],"mappings":"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","sourcesContent":["import React from 'react';\nimport 'semantic-ui-css/semantic.min.css'\n// import axios from 'axios';\nimport Register from \"./Register\"\nimport { Button, Form, Grid, Header,Message, Segment } from 'semantic-ui-react'\nimport {bS} from '../BabyTalk'\nimport {gS} from '../gSession'\n\n\nclass LoginDialog extends React.Component{\n    state = {\n\t_userName : null,\n\t_passWord : null,\n\tMessage : null,\n\tinError : false,\n    }\n\n   async handleSubmit(e){\n        e.preventDefault();  // don't reload the page\n        let uData = { userName: this.state._userName, passWord: this.state._passWord }\n\n        // axios.post('/loginVerify', uData)\n        //     .then(res => {                // and add it to the post\n\t// \t// we want to update the App state!!\n\t// \t// this component wants to update App's curUser\n\t// \tif (res.data.id === -1) {\n\t// \t    this.setState({Message :  \"Login failure\"})\n\t// \t    this.setState({inError : true})\n\t// \t}\n\t// \telse {\n\t// \t    this.props.updateAppState(this.props.appKey, res.data);\n\t// \t}\n        //     }).catch(err => {\n\t// \tconsole.log(err)\n\t//     })\n\n\n       var data =  await bS.send('/loginVerify', uData)  // talks to the babyServer\n\n\t\n\tif (data.id === -1) {\n\t    this.setState({Message :  \"Login failure\"})\n\t    this.setState({inError : true})\n\t}\n\telse {\n\t    gS.setCreds(data)\n\t    await gS.restore() // wait until we get the session\n\t    //back from the server\n\t    this.props.updateAppState(this.props.appKey, data);\n\t    // setting the curUser in App \n\t    // set the username \n\t}\n\n    }\n\n    handleChange(e) {\n\tthis.setState( {[ e.target.name ] : e.target.value} );\n\n\tif (this.state.inError){\n\t    this.setState({ inError: false});\n\t}\n\n\t\n    }\n\n    localChange = this.handleChange.bind(this);\n    localSubmit = this.handleSubmit.bind(this);\n\n    render() {\n\treturn (\n\t    <div>\n\t\t<Header as='h2' color='teal' textAlign='center'>\n\t\tFish Login \n\t    </Header>\n\t\t<Form size='large' onSubmit = {this.localSubmit} error={this.state.inError}>\n            <Segment stacked>\n\t\t<Form.Input fluid icon='user'\n\t            iconPosition='left' placeholder='UserName' type=\"text\"\n                    name = \"_userName\" onChange= {this.localChange} \n\t\t/>\n\t\t\n\t\t<Form.Input fluid  icon='lock' iconPosition='left'\n          \t    placeholder='Password' type='password'\n                    name = \"_passWord\"   onChange={this.localChange} \n\t\t/>\n\n\t\t<Button color='teal' fluid size='large'>\n                   Login\n                </Button>\n\t\t<Message error content = {this.state.Message} />\n\n            </Segment>\n\t\t</Form>\n\t    </div>\n\t);\n    }\n}\n\n\nclass RegisterButton extends React.Component{\n    render() {\n\treturn(\n\t\t<Button color='orange' fluid onClick={this.props.show}>\n      \t\tRegister New Fish\n                </Button>\n\t)\n    }\n}\n\nclass LoginForm extends React.Component{\n    state = {\n\tshowRegister : false,  // control the visibility of Register Modal\n\t// initially  false\n\t// goes to true when Register button is clicked\n\t// goes to false when we close the Register Modal\n    }\n\n    showModal(e){\n\tthis.setState ({showRegister:  true})\n    }\n    \n    killModal(e){\n\tthis.setState ({showRegister:  false})\n    }\n\n    render(){\n\treturn (\n\t    <div>\n\n\t\t<Grid textAlign='center' style={{ height: '100vh' }} verticalAlign='middle'>\n\t\t<Grid.Column style={{ maxWidth: 450 }}>\n\n\t\t<Register show = {this.state.showRegister} kill = {this.killModal.bind(this)} />\n\n\t\t<LoginDialog  \tupdateAppState = {this.props.updateAppState}\n                   appKey = {this.props.appKey} />\n\n\t\t<RegisterButton  show = {this.showModal.bind(this)} />\n\n                </Grid.Column>\n\t\t</Grid>\n\t    \n\t\t</div>\n    )\n    }\n}\n\nexport default LoginForm;\n"]},"metadata":{},"sourceType":"module"}